:root{
  --bg:#0b0f14;
  --card:#0f1621cc;
  --text:#e8eef7;
  --muted:#99a7bd;
  --accent:#6be7ff;
  --accent-2:#a779ff;
  --ok:#5cff92;
  --warn:#ffc14d;
  --err:#ff6b83;
  --ring:0 0 0 2px rgba(107,231,255,.35),0 0 40px 2px rgba(107,231,255,.15);
  --shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
  --radius:14px;
}

html, body{ height: auto; }
body{
  min-height: 100svh;
  margin: 0;
  background:
    radial-gradient(1200px 800px at 10% -10%, #142033 0%, transparent 60%),
    radial-gradient(1000px 600px at 90% -20%, #1b1140 0%, transparent 55%),
    var(--bg);
  color:var(--text);
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial;
}

.wrap{
  height: calc(100svh - 64px);
  min-height: 0;
  display: flex;
  flex-direction: column;
  max-width: 980px;
  margin-inline: auto;
  margin-block: 0;
  padding: 32px 16px;
}

.title{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:10px
}
.title h1{
  font-size:22px;
  margin:0;
  letter-spacing:.3px
}
.title .glow{
  width:12px;
  height:12px;
  border-radius:50%;
  background:linear-gradient(45deg,var(--accent),var(--accent-2));
  box-shadow:0 0 12px var(--accent)
}

/* grid 吃滿 wrap 剩餘高度，避免再用 calc(...) */
.grid{
  flex:1;
  min-height:0;                 /* 讓子元素能正確 overflow */
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

@media (max-width: 900px) {
  .grid{
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr; 
    min-height: 0;
  }

  .grid > .card:first-child{
    max-height: 35svh;
    overflow: auto;
  }
  .grid > .card:first-child .card-body{
    min-height: 0; 
  }

  /* 下面字幕卡：一定要填滿剩餘高度，#final 承接捲動 */
  .grid > .card:last-child{
    min-height: 0;
    display: flex;
    flex-direction: column;
  }
  .grid > .card:last-child .card-body{
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: auto;
  }

  /* 字幕框本身照舊：flex:1 + overflow:auto（你已設定） */
   #final { flex:1; min-height:0; overflow:auto; }
}

/* 卡片與內容區 */
.card{
  background:var(--card);
  border:1px solid rgba(255,255,255,.06);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  padding:16px;

  display:flex;
  flex-direction:column;
  min-height:0;                 /* 搭配 grid 的 min-height:0 */
}
.card .card-body{
  flex:1;
  display:flex;
  flex-direction:column;
  min-height:0;
  overflow-y: auto;
}

.row{
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap: wrap;
  margin:10px 0
}
label{color:var(--muted);font-size:13px}

/* 關閉 Edge/IE 內建的 reveal/clear 圖示 */
input[type="password"]::-ms-reveal,
input[type="password"]::-ms-clear { display: none; }

.field-wrap { position: relative; display: inline-block; }
.has-eye { padding-right: 20px; }
.eye{
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  width: 25px; height: 25px;
  display: grid; place-items: center;
  border-color: transparent;
  background: transparent;
  color: #fff;
  cursor: pointer;
}

.eye:focus{ outline: none; }
.eye .icon-off{ display: none; }
.eye.on .icon-on{ display: none; }
.eye.on .icon-off{ display: block; }
.eye svg{ width: 15px; height: 15px; pointer-events: none; }

input[type="text"],input[type="password"],select{
  color:var(--muted);
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.16);
  padding:10px 12px;
  border-radius:10px;
  outline:none;
  transition:.2s ease;
}
input:focus,select:focus{box-shadow:var(--ring);border-color:transparent}
.small{font-size:12px;color:var(--muted)}

.btn{
  appearance:none;border:none;color:#031017;font-weight:650;
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  padding:10px 16px;border-radius:999px;cursor:pointer;
  transition:transform .08s ease, filter .2s ease, box-shadow .2s ease;
  box-shadow:0 8px 18px rgba(81,177,255,.25);
  position:relative;overflow:hidden;
}
.btn:hover{filter:saturate(1.1) brightness(1.05)}
.btn:active{transform:translateY(1px)}
.btn[disabled]{opacity:.45;cursor:not-allowed;filter:grayscale(.2);animation:none!important}

.btn-ghost{
  background:transparent;color:var(--text);
  border:1px solid rgba(255,255,255,.18);
  padding:9px 14px;border-radius:999px;transition:.2s ease;
}
.btn-ghost:hover{border-color:rgba(255,255,255,.35)}

/* loading 掃光 */
.btn.loading,
.btn.loading[disabled]{cursor:not-allowed;opacity:.65;filter:grayscale(.2)}
.btn.loading::after{
  content:"";position:absolute;top:0;left:-150%;width:50%;height:100%;pointer-events:none;
  background:linear-gradient(120deg,rgba(255,255,255,0) 0%,rgba(255,255,255,.35) 45%,rgba(255,255,255,.6) 50%,rgba(255,255,255,.35) 55%,rgba(255,255,255,0) 100%);
  animation:btn-sweep 1.1s ease-in-out infinite;
}
@keyframes btn-sweep{to{left:150%}}

/* 呼吸 CTA */
.btn.cta-pulse{animation:btn-pulse 1.2s ease-in-out infinite;will-change:transform,box-shadow}
@keyframes btn-pulse{
  0%,100%{transform:scale(1);box-shadow:0 8px 18px rgba(81,177,255,.25)}
  50%{transform:scale(1.1);box-shadow:0 12px 28px rgba(81,177,255,.38)}
}

.pill{
  display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;font-size:12px;
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);
}
.pill.ok{color:#12d152;background:rgba(92,255,146,.25);border-color:rgba(92,255,146,.45)}
.pill.warn{color:#d7910e;background:rgba(255,193,77,.25);border-color:rgba(255,193,77,.45)}
.pill.err{color:#de1435;background:rgba(255,107,131,.23);border-color:rgba(255,107,131,.45)}

/* 逐字/最終字幕 */
#partial{
  min-height:28px;color:#cfd9e8;margin-top:4px;
  opacity:0;transform:translateY(6px);transition:opacity .18s ease, transform .18s ease;
}
#partial.show{opacity:1;transform:translateY(0)}
.blink{animation:blink 1s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:.35}50%{opacity:1}}

#final{
  flex:1;min-height:0;overflow:auto;          /* 可捲動、填滿卡片剩餘高度 */
  margin-top:8px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;padding:14px;white-space:pre-wrap;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
  color:#e8eef7 !important;font-size:16px !important;line-height:1.55;
}
#final .line{display:block;margin:6px 0;color:#fff !important}
#final .line .ts{
  display:inline-block;font-size:12px;padding:2px 8px;border-radius:999px;
  background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);margin-right:8px;color:#cfd9e8;
}
#final .line .tag{font-size:12px;color:#a9b7d0;margin-right:6px}
#final .line .msg{font-size:16px;line-height:1.55}

.line{margin:.2em 0}
.tag{display:inline-flex;align-items:center;gap:6px;background:rgba(255,255,255,.08);padding:2px 8px;border-radius:999px;font-size:12px}
.key{display:inline-block;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.18);padding:2px 6px;border-radius:6px;font-size:12px;margin-left:4px}

/* mic：連上後才呼吸 */
.mic{
  width:46px;height:46px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #fff, #d9fbff 45%, #7de7ff 70%, #51b1ff 100%);
  box-shadow:0 0 0 6px rgba(107,231,255,.08), 0 0 18px rgba(81,177,255,.30);
  position:relative;display:grid;place-items:center;
}
.mic::after,.mic::before{
  content:"";position:absolute;inset:-6px;border-radius:50%;
  border:2px solid rgba(107,231,255,0); /* 預設不動畫 */
}
.mic.live::after,.mic.live::before{
  border-color:rgba(107,231,255,.25);
  animation:ping 2.4s cubic-bezier(.2,.8,.2,1) infinite;
}
.mic.live::before{animation-delay:.9s}
.mic.live{animation:mic-breathe 2.4s ease-in-out infinite}
@keyframes mic-breathe{
  0%,100%{box-shadow:0 0 0 6px rgba(107,231,255,.08),0 0 28px rgba(81,177,255,.50)}
  50%{box-shadow:0 0 0 6px rgba(107,231,255,.12),0 0 40px rgba(81,177,255,.70)}
}
@keyframes ping{0%{transform:scale(1);opacity:.9}80%{opacity:.05}100%{transform:scale(1.35);opacity:0}}

/* 捲軸美化 */
::-webkit-scrollbar{height:10px;width:10px}
::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#5ae7ff77,#a779ff66);border-radius:999px}

/* 預設隱藏，桌面才出現 */
.desk-only { display: none; }
@media (min-width: 901px){
  .desk-only {
    display: block;
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px dashed rgba(255,255,255,.08);
    color: var(--muted);
  }
  .desk-only .panel-title{
    font-size: 12px; letter-spacing:.2px; color:#cfd9e8; margin-bottom:6px;
  }
  .desk-only .panel-row{ display:flex; gap:8px; flex-wrap:wrap; }
  .desk-only .panel-sec{ margin-bottom: 12px; }
  .desk-only .panel-label{ font-size:12px; margin-bottom:6px; color:#a9b7d0; }

  .desk-only .two-col{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .hotkeys{
    margin:6px 0 0; padding-left: 16px;
  }
  .hotkeys li{ margin:2px 0; }
  kbd{
    font: 11px/1 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    padding: 2px 6px; border-radius: 6px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(255,255,255,.06);
    color:#e8eef7;
  }

  .meter{
    height: 10px; border-radius: 999px;
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    overflow: hidden;
  }
  .meter span{
    display:block; height:100%;
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    transition: width .08s linear;
  }

  .countdown{
    font-size: 14px; color:#e8eef7;
    padding: 6px 10px; display:inline-block;
    border:1px solid rgba(255,255,255,.12);
    border-radius: 10px; background: rgba(255,255,255,.06);
  }
}

/* 兩欄小網格，標籤在上、slider 在下，直向排列更緊湊 */
.tune-grid{
  display: grid;
  grid-template-columns: 1fr;
  gap: 8px 12px;
  margin-bottom: 8px;
}
.tune-grid input[type="range"]{
  width: 90%;
}
.tune-grid code{
  margin-left: 6px;
  color: #e8eef7;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  padding: 2px 6px;
  border-radius: 6px;
  font-size: 12px;
}

/* 小小的 info 圖示（白色） */
.i-info{
  display:inline-grid; place-items:center;
  width:18px; height:18px; margin-left:6px;
  border-radius:50%;
  border:1px solid rgba(255,255,255,.35);
  color:#fff; font-size:12px; cursor:help; position:relative;
}
.i-info::before{ content:"i"; line-height:1; }

/* 氣泡 */
.hint { position:relative; }
.i-info::after{
  content: attr(data-tip);
  position:absolute; left:50%; bottom:150%;
  transform: translateX(-50%) translateY(6px);
  min-width: 220px; max-width: 360px;
  padding:8px 10px; font-size:12px; line-height:1.45;
  color:#e8eef7; background:rgba(20,28,40,.95);
  border:1px solid rgba(255,255,255,.12);
  border-radius:10px; box-shadow: var(--shadow);
  opacity:0; pointer-events:none; transition:opacity .15s, transform .15s;
  z-index:10;
}
.i-info:hover::after,
.i-info:focus::after{
  opacity:1; transform: translateX(-50%) translateY(0);
}

/* panel-label 排版微調 */
.panel-label { display:inline-flex; align-items:center; gap:6px; }

/* Toast 容器：預設貼在左卡內側右下角；手機時可改位置 */
.toasts{
  position: absolute;
  left: 50%;
  bottom: 16px;
  transform: translateX(-50%);
  display: grid;
  gap: 8px;
  width: calc(100% - 32px);
  justify-items: center; 
  pointer-events: none;
  z-index: 10;
}

.toast{
  display: flex; align-items: center; gap: 10px;
  padding: 10px 12px; border-radius: 12px;
  background: rgba(20,28,40,.95);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: var(--shadow);
  color: #e8eef7; font-size: 14px;
  transform: translateY(10px);
  opacity: 0;
  animation: toast-in .18s ease-out forwards;
}
.toast .ico{
  width:18px;height:18px;border-radius:50%;
  display:grid;place-items:center;flex:0 0 18px;
  font-size:12px; color:#031017;
}
.toast.ok  .ico{ background: var(--ok); }
.toast.warn .ico{ background: var(--warn); }
.toast.err .ico{ background: var(--err); }

.toast .msg{ line-height: 1.35; }

@keyframes toast-in{
  from{ opacity:0; transform: translateY(10px) }
  to  { opacity:1; transform: translateY(0) }
}
@keyframes toast-out{
  to{ opacity:0; transform: translateY(10px) }
}